<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Form-v10 by Colorlib</title>
	<!-- Mobile Specific Metas -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<!-- Font-->
	<link rel="stylesheet" type="text/css" href="css/montserrat-font.css">
	<link rel="stylesheet" type="text/css" href="fonts/material-design-iconic-font/css/material-design-iconic-font.min.css">
	<!-- Main Style Css -->
    <link rel="stylesheet" href="css/stylesignUp.css"/>
</head>
<body class="form-v10">
	<div class="page-content">
		<div class="form-v10-content">
			<form class="form-detail" action="/userLogin" method="post" id="myform">
				<div class="form-left">
					
				</div>
				<div class="form-right">
					<h2>User Login </h2>
					
					
					<div class="form-row">
						<input type="text" name="email" class="email" id="Email" placeholder="Email" required>
					</div>
               <div class="form-row">
						<input type="text" name="password" class="Password" id="Password" placeholder="Password" required>
					</div>
                <div class="form-row">
{{#if error}}
  {{error }}
  <a  style="text-decoration:solid;" href="/register"> Go to registration page</a>

{{/if}}
			</div>

				
					<div class="form-row-last">
						<input type="submit" name="register" class="register" value="Login ">
					</div>
               <div class="form-row-last m-0 py-0">

<label class="container py-0 my-0"><p>Loin With otp <a href="#" id="openModal" class="text" data-toggle="modal" data-target="#myModal">Get Otp</a></p></label>
						</label>
			   </div>
               <div class="form-row-last my-0">
						
						<label class="container py-0"><p>Don't have an account ? <a href="/register" class="text">Register</a> </p>
					</div>

				</div>
			</form>
		</div>
	</div>
	<div class="modal fade" id="myModal">
  <div class="modal-dialog">
    
      <!-- Modal Header -->
     
      
      <!-- Modal Body -->
		<div  class="form-row ">
		<div  class="form-v10-content">
			<form  class="form-detail"  method="post" id="myform">
					    <div style="background-color: aliceblue;" class="modal-content">

				<div class="form-left m-4">

      <div class="modal-body">

				<div class="form-row ">
						<input type="text" name="email" class="email" id="email" placeholder="Email Address" required>
					</div>
					<div class="form-row ">
						<input type="text" name="otp" class="name" id="otp" placeholder="Otp" required>
					</div>
					<p id="error"></p>
				</div>
			</form>
      </div>
		</div>
      
  </div>
	</div>
</div>
</body><!-- This templates was made by Colorlib (https://colorlib.com) -->
</html>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

<script>
	const emaiInput = document.getElementById('email')
	const otpInput = document.getElementById('otp')
	const error = document.getElementById('error')
    let Email = []
	emaiInput.addEventListener('keydown', function(event) {
		    if (event.key === 'Enter') {
		const email = event.target.value;
		Email = email
		if (email.trim() !== '') {
			axios.post('/generateOtp',{email})
			.then(response => {
				console.log(response.data);
				
			}).catch(function (error) {
              console.error(error); // Handle error
            });
		}
		}
	})
	otpInput.addEventListener('keydown',function(event) {
		const otp = event.target.value;
		if(otp.length=== 6) {
            axios.post('/checkOtpUser',{otp, Email})
			.then(response => {
				
              window.location.href = '/'
				
			}).catch(function(error){
				console.log(error)
			})
		}else {
          error.innerHTML='enter valid otp'
		}
		
	})
</script>